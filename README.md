# Spbu-timetable-tool

![GitHub](https://img.shields.io/github/license/sayumikko/spbu-timetable-tool)
[![CI](https://github.com/sayumikko/Spbu-timetable-tool/actions/workflows/main.yml/badge.svg)](https://github.com/sayumikko/Spbu-timetable-tool/actions/workflows/main.yml)

### Описание

Данный инструмент предназначен для обработки расписания занятий Санкт-Петербургского Государственного Университета.

### Установка

- Перейти по [ссылке](https://github.com/sayumikko/Spbu-timetable-tool/actions/workflows/main.yml)
- Выбрать последний запуск из списка
- Перейти во вкладку "Artifacts"
- Скачать и распаковать архив
- Открыть файл TeacherPreferenceUI.exe

### Возможности

На данный момент инструмент состоит из следующих частей:

1. Academic load parser
2. Excel timetable parser
3. Teacher preferences

## Библиотека academic load parser

Принимает на вход файл педагогической нагрузки в формате xlsx (пример можно
найти в файле load.xlsx директории materials) и возвращает
список дисциплин, реализуемых в данном учебном семестре, привязанных к
преподавателям и академическим группам. 

## Библиотека excel timetable parser

Принимает на вход файл расписания математико-механического факультета в формате
xlsx (пример можно найти в файдах Весна2023.xlsx и Весна2024.xlsx директории
materials) и возвращает струтурное представление timetable, которое представляет собой
информацию о времени проведения занятий у академических групп.

## Библиотека teacher preferences validation

Содержит формализованную модель пожеланий преподавателей для дальнейшей валидации
на основе расписания, получаемого с помощью библиотеки excel timetable parser.

Принимает на вход файл базы данных, соответствующий TeacherPreferencesDataModel,
в котором указаны пожелания преподавателей, и файл расписания xlsx, а затем 
проверяет, что имеющиеся пожелания совпадают с фактическим расписанием. 

## Teacher preferences UI

Содержит десктопный пользовательский интерфейс для работы с расписанием
СПбГУ на основе вышеупомянутых библиотек. При первом открытии представляет собой пустой список преподавателей и предложение открыть файл.

![Стартовое окно](https://github.com/user-attachments/assets/f133da26-167d-474c-936b-881675291323)

- Кнопка "добавить" позволяет добавить в список одного преподавателя. 

![AddTeacherWindow](https://github.com/user-attachments/assets/3ed32b62-84db-4512-bf31-01ededf6c3c6)

- Кнопка "загрузить" позволяет подать на вход файл педагогической
нагрузки, по которому заполнит список преподавателей и курсов, 
которые они ведут.

- Кнопка "очистить" удаляет всех преподавателей из спика.

- Кнопка "откройте файл" позволяет открыть файл с расписанием.
В случае, если какие-то слоты расписания не удалось прочесть,
инструмент выдаёт предупреждение о том, что именно он не смог
разобрать и позволяет проигнорировать предупреждения, нажав на
кнопку "ок". После нажатия данной кнопки он переходит к списку,
в котором отображаются все несовпадения пожеланий преподавателей
с фактическим расписанием. 

- После добавления преподавателя в список, появляется возможность
выбрать его одинарным щелчком мыши. Инструмент откроет вкладку, в 
которой можно задать предпочтения преподавателя, соответствующие
формальной модели библиотекуи teacher preference. 
